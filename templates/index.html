<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGS Infinity Value Calculator</title>
    <style>
        body { font-family: sans-serif; background-color: #1a1a1a; color: #e0e0e0; max-width: 800px; margin: 2rem auto; padding: 1rem; }
        h1, h2 { text-align: center; color: #4d94ff; }
        .container { background-color: #2b2b2b; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); }
        form { display: flex; flex-direction: column; gap: 1rem; }
        label { font-weight: bold; }
        input[type="text"] { padding: 0.75rem; border-radius: 4px; border: 1px solid #444; background-color: #333; color: #fff; font-size: 1rem; }
        button { background-color: #4d94ff; color: white; padding: 0.75rem; border: none; border-radius: 4px; font-size: 1.1rem; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #367dff; }
        .results-summary { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #444; }
        .error { color: #ff6b6b; text-align: center; font-weight: bold; margin-bottom: 1rem; }
        .pet-card { background-color: #333; border: 1px solid #444; border-radius: 5px; padding: 1rem; margin-bottom: 1rem; }
        .pet-card p { margin: 0.5rem 0; }
        .pet-card strong { color: #87baff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>BGS Infinity Value Calculator</h1>

        <form method="POST" action="/">
            <label for="pets">Pet Name(s) (comma-separated):</label>
            <input type="text" id="pets" name="pets" value="{{ search_input }}" placeholder="e.g., Angel, Ocelot" required>

            <label for="variants">Variant(s) (name or number, comma-separated):</label>
            <input type="text" id="variants" name="variants" value="{{ variant_input }}" placeholder="e.g., shiny, 3, all" required>
            <small>Variants: 0/All, 1/Normal, 2/Shiny, 3/Mythic, 4/ShinyMythic</small>
            
            <button type="submit">Calculate Value</button>
        </form>

        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}

        <div class="results-summary">
            {% if total_value > 0 %}
                <h2>Total Calculated Value: {{ "{:,.0f}".format(total_value) }}</h2>
            {% endif %}

            {% if results %}
                <h2>Found Pets:</h2>
                {% for pet in results %}
                    <div class="pet-card">
                        <p><strong>Name:</strong> {{ pet.name }}</p>
                        <p><strong>Variant:</strong> {{ pet.variant }}</p>
                        <p><strong>Value:</strong> {{ pet.value }} (Calculated as {{ "{:,.0f}".format(pet.calculated_value) }})</p>
                        <p><strong>Demand:</strong> {{ pet.demand }}</p>
                        <p><strong>Owners:</strong> {{ pet.owners }}</p>
                        <p><strong>Status:</strong> {{ pet.status }}</p>
                        <p><strong>Source Link:</strong> <a href="{{ pet.link }}" target="_blank">View API Source</a></p>
                    </div>
                {% endfor %}
            {% elif request.method == 'POST' %}
                 <p style="text-align: center;">No pets found for the given search terms and variants.</p>
            {% endif %}
        </div>
    </div>
</body>
</html>